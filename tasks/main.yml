---

- name: Docker configuration
  include_tasks: docker_conf.yml


#https://github.com/kubernetes/kubernetes/issues/71305
#https://docs.oracle.com/en/operating-systems/oracle-linux/kubernetes/kube_admin_config.html#kube_admin_config_iptables
- name: Aceptar Forwarding
  iptables:
    chain: FORWARD
    jump: ACCEPT


#- name: Deploy hello-go
#  include_tasks: deploy_hello_go.yml

#- name: Deploy hello-k8s
#  include_tasks: deploy_hello_k8s.yml

- name: Deploy tomcat
  include_tasks: deploy_tomcat.yml

- name: Deploy MySQL
  include_tasks: deploy_mysql.yml

- name: Deploy Mattermost
  include_tasks: deploy_mattermost.yml

- name: Deploy Prometheus
  include_tasks: deploy_prometheus.yml

- name: Create secrets for apps
  include_tasks: setup_secrets_apps.yml
  when: apps_to_deploy is defined

- name: Create secrets for k8s dashboard
  include_tasks: setup_secrets_dashb.yml
  when: kubernetes_enable_web_ui

- name: Create admin user for dashboard
  include_tasks: set_admin_dashb.yml
  when: kubernetes_enable_web_ui and kubernetes_create_admin_dashb_user

- name: Setup nginx ingress
  include_tasks: setup_nginx_ingress.yml


# vim: ff=unix:ai:et:sw=2:ts=2:
